<link rel="stylesheet" href="styles/student_view.css">

    <!-- Top half -->
    <div class="row">
      <div class="col-lg-6">
        <canvas id="pdfviewer"></canvas>
        <div class="Buttons">
          <div class="Left-Button" ng-class="{'Side-Hover' : sides.left_hover}" 
                                   ng-mouseover="sides.left_hover = true"
                                   ng-mouseleave="sides.left_hover = false">
            <div id="prev"><i class="fa fa-angle-left fa-2x" aria-hidden="true"></i></div>
          </div>
          <div class="Middle-Button" ng-click="current"> 
            <div id="curr">Current</div>
          </div>
          <div class="Right-Button" ng-class="{'Side-Hover' : sides.right_hover}" 
                                    ng-mouseover="sides.right_hover = true"
                                    ng-mouseleave="sides.right_hover = false">
            <div id="next"><i class="fa fa-angle-right fa-2x" aria-hidden="true"></i></div>
          </div>
        </div>
        <div class="Vote-Buttons">
          <button ng-click="happy"><i class="fa fa-smile-o fa-3x" aria-hidden="true"></i></button>
          <button ng-click="unhappy"><i class="fa fa-frown-o fa-3x" aria-hidden="true"></i></button>
          <button ng-click="fast">Too Slow</button>
          <button ng-click="slow">Too Fast</button>
        </div>
        <div class="Bar-Container">
          <p class="lead">Current class status</p>
          <div class="progress progress">
            <div id="red_bar" class="progress-bar progress-bar-danger" style="width: 80%"></div>
            <div class="progress-bar progress-bar-warning" style="width: 0%"></div>
            <div id="green_bar" class="progress-bar progress-bar-success" style="width: 20%"></div>
          </div>
        </div>
      </div>

      <div class="col-lg-6">
        <div class="Rightpage-Container">
          <p class="lead"> Questions </p> 
          <p class="lead normal-font" ng-repeat="q in ques">
            <span class="lead normal-font">{{ q.question }} - {{ q.votes }}</span>
            <button ng-click="upvote($index)"><i class="fa fa-thumbs-up" aria-hidden="true"></i></button>
          </p>
        </div>
        <form role="form" ng-submit="addQuestion()">
          <input id="question" type="text" ng-model="question" placeholder="Ask a Question!">
          <input type="submit" value="Ask" style="float: right">
        </form>
      </div>
    </div>

    <!-- websocket control -->
    <script>
      console.log('websocket.js used');
      var socket = new WebSocket('ws://127.0.0.1:8000/all/');
      socket.onmessage = function(message){
        var data = JSON.parse(message.data);
        if(data.type == 'bar'){
          document.getElementById('red_bar').style.width = data.red_bar + '%';
          document.getElementById('green_bar').style.width = data.green_bar + '%';
        }

      }
    </script>

    <!-- pdfjs control -->
    <script>
      var url ='http://127.0.0.1:8000/slides/get_pdf';
      //window.open(url);
      console.log(url);
      var maxPages = 0;
      var scale = 1.5;
      var canvas = document.getElementById('pdfviewer');
      var context = canvas.getContext('2d');
      var viewport = 0;
      var renderContext = 0;
      var page_no = 1;
      getPDF();
      function getPDF() {
        PDFJS.disableWorker = true;
      //  PDFJS.workerSrc = "scripts/pdf.worker.js";
        PDFJS.getDocument(url).then(function getPdfViewer(pdf) {
          // Fetch the first page
          maxPages = pdf.numPages;
          pdf.getPage(page_no).then(function getPageViewer(page) {
            viewport = page.getViewport(scale);
            // Prepare canvas using PDF page dimensions
            canvas.height = viewport.height;
            canvas.width = viewport.width;
            // Render PDF page into canvas context
            renderContext = {
              canvasContext: context,
              viewport: viewport
            };
            page.render(renderContext);
          });
      //    checkmax();
        });
      }
  </script>
